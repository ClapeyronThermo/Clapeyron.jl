<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Pure Saturation Properties · Clapeyron.jl</title><meta name="title" content="Pure Saturation Properties · Clapeyron.jl"/><meta property="og:title" content="Pure Saturation Properties · Clapeyron.jl"/><meta property="twitter:title" content="Pure Saturation Properties · Clapeyron.jl"/><meta name="description" content="Documentation for Clapeyron.jl."/><meta property="og:description" content="Documentation for Clapeyron.jl."/><meta property="twitter:description" content="Documentation for Clapeyron.jl."/><meta property="og:url" content="https://ClapeyronThermo.github.io/Clapeyron.jl/tutorials/pure_saturation_curves/"/><meta property="twitter:url" content="https://ClapeyronThermo.github.io/Clapeyron.jl/tutorials/pure_saturation_curves/"/><link rel="canonical" href="https://ClapeyronThermo.github.io/Clapeyron.jl/tutorials/pure_saturation_curves/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/logo.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="Clapeyron.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Clapeyron.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../installation/">Installation</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../basics_model_construction/">Getting Started - Model Construction</a></li><li><a class="tocitem" href="../user_defined_parameters/">User-defined Parameters</a></li><li><a class="tocitem" href="../bulk_properties/">Bulk Properties</a></li><li><a class="tocitem" href="../mixing_functions/">Mixing and Excess Functions</a></li><li class="is-active"><a class="tocitem" href>Pure Saturation Properties</a><ul class="internal"><li><a class="tocitem" href="#Saturation-curve-of-water"><span>Saturation curve of water</span></a></li><li><a class="tocitem" href="#Critical-points"><span>Critical points</span></a></li><li><a class="tocitem" href="#Obtaining-properties-along-the-saturation-curve"><span>Obtaining properties along the saturation curve</span></a></li></ul></li><li><a class="tocitem" href="../binary_phase_diagrams/">Binary Phase Diagrams</a></li><li><a class="tocitem" href="../ternary_phase_diagrams/">Ternary Phase Diagrams</a></li><li><a class="tocitem" href="../sle_phase_diagrams/">SLE Phase Diagrams</a></li></ul></li><li><a class="tocitem" href="../../notebook_examples/">Notebook Examples</a></li><li><span class="tocitem">Available EoS</span><ul><li><a class="tocitem" href="../../eos/ideal/">Ideal Models</a></li><li><a class="tocitem" href="../../eos/cubic/">Cubic Models</a></li><li><a class="tocitem" href="../../eos/activity/">Activity Models</a></li><li><a class="tocitem" href="../../eos/saft/">SAFT and CPA Models</a></li><li><a class="tocitem" href="../../eos/empiric/">Empiric Helmholtz Models</a></li><li><a class="tocitem" href="../../eos/correlations/">Property Correlations</a></li><li><a class="tocitem" href="../../eos/misc/">Other Models</a></li></ul></li><li><a class="tocitem" href="../../faq/">Frequently Asked Questions</a></li><li><span class="tocitem">Available Properties</span><ul><li><a class="tocitem" href="../../properties/basic/">Basic Properties</a></li><li><a class="tocitem" href="../../properties/bulk/">Bulk Properties</a></li><li><a class="tocitem" href="../../properties/single/">Single phase Properties</a></li><li><a class="tocitem" href="../../properties/multi/">Multiphase Properties</a></li><li><a class="tocitem" href="../../properties/electrolytes/">Electrolyte Properties</a></li></ul></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../../api/parameters/">Parameters</a></li><li><a class="tocitem" href="../../api/macros/">Macros</a></li><li><a class="tocitem" href="../../api/association/">Association</a></li><li><a class="tocitem" href="../../api/estimation/">Parameter Estimation</a></li></ul></li><li><a class="tocitem" href="../../to-do_list/">To-do list</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Pure Saturation Properties</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Pure Saturation Properties</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ClapeyronThermo/Clapeyron.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/ClapeyronThermo/Clapeyron.jl/blob/master/docs/src/tutorials/pure_saturation_curves.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Pure-Saturation-Properties"><a class="docs-heading-anchor" href="#Pure-Saturation-Properties">Pure Saturation Properties</a><a id="Pure-Saturation-Properties-1"></a><a class="docs-heading-anchor-permalink" href="#Pure-Saturation-Properties" title="Permalink"></a></h1><p>Saturation properties are often vital when understanding the global phase behaviour of a pure component. Such properties can be obtained in <code>Clapeyron.jl</code>.</p><p>The notebooks associated with this tutorial can be found <a href="../../../examples/pure_saturation_properties.ipynb">here</a>.</p><h2 id="Saturation-curve-of-water"><a class="docs-heading-anchor" href="#Saturation-curve-of-water">Saturation curve of water</a><a id="Saturation-curve-of-water-1"></a><a class="docs-heading-anchor-permalink" href="#Saturation-curve-of-water" title="Permalink"></a></h2><p>Let us take the case of obtaining the boiling point of water at atmospheric pressure using Peng–Robinson. This can be obtained using the <code>saturation_temperature(model,p)</code> function as shown below:</p><pre><code class="language-julia hljs">julia&gt; model = PR([&quot;water&quot;])
PR{BasicIdeal, PRAlpha, NoTranslation, vdW1fRule} with 1 component:
 &quot;water&quot;
Contains parameters: a, b, Tc, Pc, Mw

julia&gt; (Tsat, vl, vv) = saturation_temperature(model, 1e5)
(374.24014010712983, 2.26976016480195e-5, 0.03084938795573781)</code></pre><p>Note that the outputs of this function are the saturation temperature, saturated liquid volume and saturated vapour volume. The predicted saturation temperature is pretty spot-on for a cubic although the liquid volume is a bit off (see documentation related to <a href="../basics_model_construction/">model construction</a> to see how cubics can be improved to better model complex systems).</p><p>If we wished to do the reverse operation, obtain the saturation pressure at a given temperature, this can be done using the <code>saturation_pressure(model, T)</code> function:</p><pre><code class="language-julia hljs">julia&gt; (psat, vl, vv) = saturation_pressure(model,298.15)
(2686.6049469327368, 2.1391026105178707e-5, 0.9223293617932997)</code></pre><p>In fact, if one wishes to trace the full saturation curve of a component, it is recommended to use this function instead. The primary reason for this is because, as one approaches the critical point, our solvers will become more unstable (just the nature of the critical region). As such, to obtain a smooth curve, it is often best to solve for the saturation conditions far from the critical point first, and then slowly approach the critical point, reusing values from lower temperatures as initial guesses for the next step. Consider an example for-loop below:</p><pre><code class="language-julia hljs">N    = 100

T    = LinRange(298.15, Tc, N)
psat = zeros(N)
vl   = zeros(N)
vv   = zeros(N)

for i in 1:N
    if i==1
        sat = saturation_pressure(model, T[i])
        psat[i] = sat[1]
        vl[i] = sat[2]
        vv[i] = sat[3]
        v0 = [vl[i],vv[i]]
    else
        sat = saturation_pressure(model, T[i]; v0=v0)
        psat[i] = sat[1]
        vl[i] = sat[2]
        vv[i] = sat[3]
        v0 = [vl[i],vv[i]]
    end
end</code></pre><p>The resulting <span>$pT$</span> curve is shown below:</p><p><img src="../../assets/pT_water.svg" alt="pT_water"/></p><p>As well as the <span>$\rho T$</span> envelope:</p><p><img src="../../assets/rhoT_water.svg" alt="rhoT_water"/></p><h3 id="Using-alternative-methods"><a class="docs-heading-anchor" href="#Using-alternative-methods">Using alternative methods</a><a id="Using-alternative-methods-1"></a><a class="docs-heading-anchor-permalink" href="#Using-alternative-methods" title="Permalink"></a></h3><p>The default methods in <code>Clapeyron.jl</code> are generally intended for speed, with sacrifices to robustness. As such there will probably be a few cases where our default methods fail. While this could be remedied by the user providing their own initial guesses, an alternative would be to use a different method. In the case of the saturation solvers, we have a few alternatives listed <a href="../properties/pure.md">elsewhere</a>. This switch can be done as follows:</p><pre><code class="language-julia hljs">julia&gt; @time saturation_pressure(model, 298.15)
  0.000024 seconds (11 allocations: 432 bytes)
(2686.6049469327368, 2.1391026105178707e-5, 0.9223293617932997)

julia&gt; @time saturation_pressure(model, 298.15, IsoFugacitySaturation())
  0.000026 seconds (8 allocations: 480 bytes)
(2686.6049471489205, 2.139102610517806e-5, 0.9223293617190517)

julia&gt; @time saturation_pressure(model, 298.15, SuperAncSaturation())
  0.000006 seconds (1 allocation: 32 bytes)
(2686.604947149002, 2.13910261051781e-5, 0.922329361719024)</code></pre><p>The list of available saturation methods are the following:</p><ul><li><p><a href="../../properties/single/#Clapeyron.ChemPotVSaturation"><code>ChemPotVSaturation</code></a>: Default method, solves simultaneously both liquid and vapour volumes as a non linear system of equations. Fastest, but could have some problems too close to the critical point.</p></li><li><p><a href="../../properties/single/#Clapeyron.IsoFugacitySaturation"><code>IsoFugacitySaturation</code></a>: Solves a univariate Root-finding problem with pressure as main variable. For each iteration calculates a liquid and vapour volume, It is more stable in some cases.</p></li><li><p><a href="@ref"><code>CritExtrapolationSaturation</code></a>: Returns a critical extrapolation approximation of the saturation conditions. Really accurate for <span>$T/T_\mathrm{c} &gt; 0.999$</span>. It is used as initial point for the other saturation methods when a critical point is available.</p></li><li><p><a href="@ref"><code>SuperAncSaturation</code></a>: The method just evaluates a highly regressed Chebyshev polynomial for pressure and saturation volumes, by far the fastest method, but it&#39;s only available for <code>vdW</code>, <code>RK</code> and <code>PR</code> equations of state.</p></li></ul><div class="admonition is-info"><header class="admonition-header">External Packages: EoSSuperancillaries.jl</header><div class="admonition-body"><p>By default, <code>Clapeyron.jl</code> only provides superancillaries for the aforementioned cubics. <a href="https://github.com/ClapeyronThermo/EoSSuperancillaries.jl"><code>EoSSuperancillaries.jl</code></a> provides an additional superancillary for the PCSAFT equation of state (without association). In addition to the PCSAFT superancillary, loading the package switches the initial points for the saturation methods to use the superancillaries themselves, resulting in additional speedups. This behaviour can be switched off by setting <code>Clapeyron.SUPERANC_ENABLED[] = false</code>, after loading <code>EoSSuperancillaries</code>.</p></div></div><h2 id="Critical-points"><a class="docs-heading-anchor" href="#Critical-points">Critical points</a><a id="Critical-points-1"></a><a class="docs-heading-anchor-permalink" href="#Critical-points" title="Permalink"></a></h2><p>Omitted from the example we gave earlier, one can also solve for the critical point of a pure component in <code>Clapeyron.jl</code> directly. This is done simply using the <code>crit_pure(model)</code> function:</p><pre><code class="language-julia hljs">julia&gt; (Tc, pc, vc) = crit_pure(model)
(647.13, 2.19e7, 7.644674198270991e-5)</code></pre><p>While, in the case of cubics, the critical point is an input, for equations of state such as SAFT, the critical point needs to be determined when trying to trace the saturation region.</p><h2 id="Obtaining-properties-along-the-saturation-curve"><a class="docs-heading-anchor" href="#Obtaining-properties-along-the-saturation-curve">Obtaining properties along the saturation curve</a><a id="Obtaining-properties-along-the-saturation-curve-1"></a><a class="docs-heading-anchor-permalink" href="#Obtaining-properties-along-the-saturation-curve" title="Permalink"></a></h2><p>Properties such as the enthalpy of vaporisation or saturated heat capacities can be quite important to determine. Ideally, once the saturation pressure and temperature is determined, one should be able to input those values into the bulk property calculators, specifying the respective phases. While this does work generally, this approach begins to fail at conditions approaching the critical point (unsurprisingly). In this case, we recommend using hidden functions in <code>Clapeyron.jl</code>, the <code>Clapeyron.VT_property(model, V, T, n)</code> functions. Rather than taking the pressure as an input, these functions take the system volume. As we have obtained these volumes from the saturation solvers, it ensures that we obtain the property related to the correct phase. This is shown below for the enthalpy of vaporisation saturated heat capacities:</p><pre><code class="language-julia hljs">N    = 100

T    = LinRange(298.15, Tc, N)
psat = zeros(N)
vl   = zeros(N)
vv   = zeros(N)

hL   = zeros(N)
hV   = zeros(N)
cpL  = zeros(N)
cpV  = zeros(N)

for i in 1:N
    if i==1
        sat = saturation_pressure(model, T[i])
        psat[i] = sat[1]
        vl[i] = sat[2]
        vv[i] = sat[3]
        v0 = [vl[i],vv[i]]
    else
        sat = saturation_pressure(model, T[i]; v0=v0)
        psat[i] = sat[1]
        vl[i] = sat[2]
        vv[i] = sat[3]
        v0 = [vl[i],vv[i]]
    end
    hL[i]  = Clapeyron.VT_enthalpy(model,vl[i],T[i],[1.])
    hV[i]  = Clapeyron.VT_enthalpy(model,vv[i],T[i],[1.])
    cpL[i] = Clapeyron.VT_isobaric_heat_capacity(model,vl[i],T[i],[1.])
    cpV[i] = Clapeyron.VT_isobaric_heat_capacity(model,vv[i],T[i],[1.])
end</code></pre><p>The resulting plots are shown below:</p><p><img src="../../assets/hvap_water.svg" alt="hvap_water"/></p><p>As well as the saturated isobaric heat capacities:</p><p><img src="../../assets/cpsat_water.svg" alt="cpsat_water"/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../mixing_functions/">« Mixing and Excess Functions</a><a class="docs-footer-nextpage" href="../binary_phase_diagrams/">Binary Phase Diagrams »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Friday 31 January 2025 16:20">Friday 31 January 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
