<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>- · Clapeyron.jl</title><meta name="title" content="- · Clapeyron.jl"/><meta property="og:title" content="- · Clapeyron.jl"/><meta property="twitter:title" content="- · Clapeyron.jl"/><meta name="description" content="Documentation for Clapeyron.jl."/><meta property="og:description" content="Documentation for Clapeyron.jl."/><meta property="twitter:description" content="Documentation for Clapeyron.jl."/><meta property="og:url" content="https://ClapeyronThermo.github.io/Clapeyron.jl/theory/background/"/><meta property="twitter:url" content="https://ClapeyronThermo.github.io/Clapeyron.jl/theory/background/"/><link rel="canonical" href="https://ClapeyronThermo.github.io/Clapeyron.jl/theory/background/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/logo.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="Clapeyron.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Clapeyron.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../installation/">Installation</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorials/basics_model_construction/">Getting Started - Model Construction</a></li><li><a class="tocitem" href="../../tutorials/user_defined_parameters/">User-defined Parameters</a></li><li><a class="tocitem" href="../../tutorials/bulk_properties/">Bulk Properties</a></li><li><a class="tocitem" href="../../tutorials/mixing_functions/">Mixing and Excess Functions</a></li><li><a class="tocitem" href="../../tutorials/pure_saturation_curves/">Pure Saturation Properties</a></li><li><a class="tocitem" href="../../tutorials/binary_phase_diagrams/">Binary Phase Diagrams</a></li><li><a class="tocitem" href="../../tutorials/ternary_phase_diagrams/">Ternary Phase Diagrams</a></li><li><a class="tocitem" href="../../tutorials/sle_phase_diagrams/">SLE Phase Diagrams</a></li><li><a class="tocitem" href="../../tutorials/xy_flash/">Other Flash Computations</a></li></ul></li><li><a class="tocitem" href="../../notebook_examples/">Notebook Examples</a></li><li><span class="tocitem">Available EoS</span><ul><li><a class="tocitem" href="../../eos/ideal/">Ideal Models</a></li><li><a class="tocitem" href="../../eos/cubic/">Cubic Models</a></li><li><a class="tocitem" href="../../eos/activity/">Activity Models</a></li><li><a class="tocitem" href="../../eos/saft/">SAFT and CPA Models</a></li><li><a class="tocitem" href="../../eos/empiric/">Empiric Helmholtz Models</a></li><li><a class="tocitem" href="../../eos/correlations/">Property Correlations</a></li><li><a class="tocitem" href="../../eos/misc/">Other Models</a></li></ul></li><li><a class="tocitem" href="../../faq/">Frequently Asked Questions</a></li><li><span class="tocitem">Available Properties</span><ul><li><a class="tocitem" href="../../properties/basic/">Basic Properties</a></li><li><a class="tocitem" href="../../properties/bulk/">Bulk Properties</a></li><li><a class="tocitem" href="../../properties/single/">Single phase Properties</a></li><li><a class="tocitem" href="../../properties/multi/">Multiphase Properties</a></li><li><a class="tocitem" href="../../properties/electrolytes/">Electrolyte Properties</a></li></ul></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../../api/parameters/">Parameters</a></li><li><a class="tocitem" href="../../api/macros/">Macros</a></li><li><a class="tocitem" href="../../api/association/">Association</a></li><li><a class="tocitem" href="../../api/estimation/">Parameter Estimation</a></li></ul></li><li><a class="tocitem" href="../../to-do_list/">To-do list</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>-</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>-</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ClapeyronThermo/Clapeyron.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/ClapeyronThermo/Clapeyron.jl/blob/master/docs/src/theory/background.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h2 id="Models"><a class="docs-heading-anchor" href="#Models">Models</a><a id="Models-1"></a><a class="docs-heading-anchor-permalink" href="#Models" title="Permalink"></a></h2><p>Here, we give a high-level description of equations of state and the models provided by <code>Clapeyron</code>.</p><h3 id="Equations-of-state"><a class="docs-heading-anchor" href="#Equations-of-state">Equations of state</a><a id="Equations-of-state-1"></a><a class="docs-heading-anchor-permalink" href="#Equations-of-state" title="Permalink"></a></h3><p>An equation of state is a functional form, <span>$f$</span> (say), that allows us to obtain a thermodynamic property, <span>$F$</span>, at given conditions <span>$\boldsymbol{\Omega}$</span>:</p><p><span>$F = f(\boldsymbol{\Omega};\boldsymbol{\Xi})$</span>.</p><p>There are many ways one can develop an equation of state, however, these must respect the constraints on the number of properties we can specify, as required by the Gibbs Phase Rule:</p><p><span>$\mathrm{DoF} = N_\mathrm{species} - N_\mathrm{phase} + 2$</span></p><p>Here, <span>$\mathrm{DoF}$</span> means &quot;Degrees of Freedom&quot;; this is the number of so-called intensive state properties (or, in other words, those that are independent of system size) that we can specify. As we can see, the largest number of degrees of freedom we can have is <span>$N_\mathrm{species}+1$</span>; system size itself is not included so, in practice, this represents one more variable that we can specify, giving <span>$N_\mathrm{species}+2$</span>. Thus, taking the simple case of a single species, we can specify at most three conditions in our system. For a traditional equation of state, we specify volume, <span>$V$</span>, temperature, <span>$T$</span>, and the size of the system – for example the number of particles, <span>$N$</span>, or moles, <span>$n$</span>; the equation of state then returns the pressure, <span>$p$</span>. Many modern equations of state are derived using what is known as the canonical ensemble (more information can be found in Statistical Mechanics textbooks) and, accordingly, the three variable chosen are again usually <span>$T$</span>, <span>$V$</span> and <span>$N$</span>; the output of these equations is usually the Helmholtz energy, <span>$A$</span>.</p><p>Many equations of state are based on an underlying molecular model. Consequently, it is also typical for an equation of state to require parameters, <span>$\boldsymbol{\Xi}$</span>, to model certain species. The nature of these parameters depends on the equation of state.</p><h3 id="Ideal-gas-equation-of-state"><a class="docs-heading-anchor" href="#Ideal-gas-equation-of-state">Ideal gas equation of state</a><a id="Ideal-gas-equation-of-state-1"></a><a class="docs-heading-anchor-permalink" href="#Ideal-gas-equation-of-state" title="Permalink"></a></h3><p>One equation of state that most engineers and scientists should be very familiar with is the ideal gas equation, commonly expressed as:</p><p><span>$pV = Nk_\mathrm{B}T$</span></p><p>where <span>$p$</span> is the pressure, <span>$N$</span> is the total number of particles and <span>$k_\mathrm{B}$</span> is the Boltzmann constant. Ideal gas molecules are &quot;invisible&quot; to each other; there is zero interaction between ideal gas molecules (this is, in essence, the ideal gas model), so you can think of them as being infinitely small. This equation was first written down (although in slightly different form) in 1834 by Émile Clapeyron (in whose honour <code>Clapeyron</code> is named). Most (if not all) subsequent equations of state are descended from Clapeyron&#39;s equation, which is surprisingly appropriate for a wide variety of species in the gas phase at high enough temperature and low enough pressure.</p><p>Unfortunately, if we wish to determine other thermodynamic properties this equation is a little inconvenient. It would be much easier if it was expressed in the form of the free energy, from which other properties can then be evaluated using standard thermodynamic relationships. Accordingly, we could first integrate the above equation with respect to volume to determine the Helmholtz energy:</p><p><span>$A_\mathrm{ideal} =- \int p\,dV =- Nk_\mathrm{B}T\ln{V}+c(T,N)$</span></p><p>This is still a little inconvenient, however, since we have to deal with a tricky constant of integration. Fortunately, we can instead derive <span>$A_\mathrm{ideal}$</span> from statistical mechanics (using just a few well-known results from quantum mechanics). Following this route, we obtain (for a pure component (i.e., a single species))</p><p><span>$\frac{A_\mathrm{ideal}}{Nk_\mathrm{B}T} = \ln{(\rho\Lambda^3)}-1$</span>,</p><p>where <span>$\rho = N/V$</span> is the number density, and <span>$\Lambda$</span> is the thermal de Broglie wavelength, which introduces the kinetic contributions to the free energy (strictly speaking, with this notation only translations are included). We can generalise this as a sum over species <span>$i$</span> for a multi-component mixture:</p><p><span>$\frac{A_\mathrm{ideal}}{Nk_\mathrm{B}T} = \left(\sum_ix_i\ln{(\rho_i\Lambda_i^3)}\right)-1$</span>,</p><p>where <span>$x_i$</span> is the molar composition, and the subscript denote that the variable so decorated relates to species <span>$i$</span>. This equation represents the <code>MonomerIdeal</code> form in <code>Clapeyron</code>. For the purposes of vapour–liquid equilibrium properties, one can even ignore <span>$\Lambda_i$</span> (since it cancels out in solving the phase equilibrium); we therefore use this as the default <code>BasicIdeal</code> model.</p><p>The kinetic energy of polyatomic species includes contributions from vibrational and rotational modes of motion, as well as translational; we must also account for these in the ideal free energy. The statistical–mechanical derivation of the ideal free energy becomes a little more complicated but can still be done, resulting in the following expression:</p><p><span>$\frac{A_{\mathrm{ideal}}}{Nk_{\mathrm{B}}T}=\sum_{i}x_{i}\bigg[\ln\left(\rho_{i}\Lambda_{i}^{3}\right)-\frac{N_{\mathrm{rot},i}}{2} \ln \frac{T}{\theta_{\mathrm{rot},i}}+\sum^{N_{\mathrm{vib},i}}_{\mathrm{v}}g_{i,\mathrm{v}}\left[\frac{\theta_{\mathrm{vib},i,\mathrm{v}}}{2T}+\ln\left(1-\exp{-(\theta_{\mathrm{vib},i,\mathrm{v}}/T)}\right)\right]-1\bigg]$</span>.</p><p>Here <span>$N_{\mathrm{rot},i}$</span>, <span>$\theta_{\mathrm{rot},i}$</span> and <span>$N_{\mathrm{vib},i}$</span> are the number of rotations, the number of vibrations and the rotational temperature of a species <span>$i$</span>, respectively; <span>$g_{i,\mathrm{v}}$</span> and <span>$\theta_{\mathrm{vib},i,\mathrm{v}}$</span> represent the degeneracy and vibrational temperature of a vibrational mode <span>$\mathrm{v}$</span> of species <span>$i$</span>. The <code>WalkerIdeal</code> model provides the necessary parameters to use such an equation. However, the morecommonly used approach is through the use of correlations of the ideal isobaric heat capacity, <span>$C_{p,i}^0$</span>, such as the <code>ReidIdeal</code>, <code>WilhoitIdeal</code> and <code>AlyLeeIdeal</code> models. From the ideal isobaric heat capacity, it is possible to determine the ideal Helmholtz energy using the following equation:</p><p><span>$\frac{A_{\mathrm{ideal}}}{Nk_\mathrm{B}T} = \sum_{i=1}^{N_{\mathrm{Component}}} x_i\left[\ln{\frac{\rho_i}{\rho_0}}     + \frac{1}{Nk_\mathrm{B}T} \int_{T_0}^T \!\!C_{p,i}^0 dT + \frac{H_{0,i}}{Nk_\mathrm{B}T}- \frac{1}{Nk_{B}}\!\!\int_{T_0}^T \frac{C_{p,i}^0}{T} dT -\ln{\frac{T}{T_0}}-\frac{S_{0,i}}{Nk_\mathrm{B}} - 1\right]$</span></p><p>Note that the reference states, <span>$\rho_0$</span>, <span>$H_{0,i}$</span> and <span>$S_{0,i}$</span>, can typically be neglected as these will not impact or contribute to most thermodynamic properties of interest.</p><h3 id="Cubic-equations-of-state"><a class="docs-heading-anchor" href="#Cubic-equations-of-state">Cubic equations of state</a><a id="Cubic-equations-of-state-1"></a><a class="docs-heading-anchor-permalink" href="#Cubic-equations-of-state" title="Permalink"></a></h3><p>This is the mostpopular class of equations of state. The progenitor of these is the Van der Waals (<code>vdW</code>) equation of state, published in 1873, which can be written as:</p><p><span>$p = \frac{Nk_\mathrm{B}T}{V-Nb}-\frac{N^2a}{V^2}$</span></p><p>where <span>$a$</span> and <span>$b$</span> are the model parameters. Although the vdW equation was phenomenological in origin, it, too, can be derived from statistical thermodynamics. Strictly speaking, <span>$b$</span> accounts for the space taken up by the molecules themselves (it corresponds to the excluded volume per molecule) and <span>$a$</span> quantifies the magnitude of attraction between species. As a result, the first term is often thought of as accounting for the repulsive interactions between molecules, while the second accounts for attractive interactions. In principle, therefore, one could obtain values of <span>$a$</span> and <span>$b$</span> for a particular species from (for example) spectroscopic information. However, since <span>$a$</span> and <span>$b$</span> can be related to the critical temperature and pressure of the vdW fluid, to relate the equation of state to a particular species, it is conventional to use the critical temperature and pressure of the species to obtain working values of the parameters.</p><p>Unfortunately, although its simple functional form makes calculations quite straightforward, the vdW equation is inadequate for quantitative modelling, particularly for volumetric properties, and is most useful only for providing a qualitative description of the thermodynamic properties of the fluid. As a result, many other engineering cubic equations have been developed, retaining (as far as possible) the simple mathematical form of Van der Waals&#39; equation. The first noteworthy one of these is the Redlich–Kwong (<code>RK</code>) equation:</p><p><span>$p = \frac{Nk_\mathrm{B}T}{V-Nb}-\frac{N^2a}{\sqrt{T}V(V+Nb)}$</span></p><p>There is no physical justification for the change in the second term; its origin is entirely empirical. The authors made the modification so that the equation would provide better gas phase fugacities. This equation was subsequently improved upon by Soave, resulting in the <code>SRK</code> equation of state:</p><p><span>$p = \frac{Nk_\mathrm{B}T}{V-Nb}-\frac{N^2\alpha(T;\omega)}{V(V+Nb)}$</span></p><p>The <span>$\alpha$</span> function requires an additional parameter, the acentric factor (or acentricity), which is effectively a measure of the location of the saturation pressure when <span>$T/T_\mathrm{c}=0.7$</span>, where <span>$T_\mathrm{c}$</span> is the critical temperature. The idea behind this is, if you can capture both the critical point and another point along the vapour–pressure curve, you will improve the accuracy of your equation of state. This is indeed what happened. Although Soave described his equation as a &quot;modified Redlich–Kwong equation&quot;, in truth it is more than this. The introduction of the <span>$\alpha$</span> function represents a giant step forwards; the inclusion of a similar <span>$\alpha$</span> function is probably the key feature in the equation of Peng and Robinson, who introduced their equation of state (<code>PR</code>) to provide improved liquid-phase volumetric properties. In addition to the inclusion of an <span>$\alpha$</span> function, Peng and Robinson further revised the attractive term:</p><p><span>$p = \frac{Nk_\mathrm{B}T}{V-Nb}-\frac{N^2\alpha(T;\omega)}{V^2+2NbV+b^2N^2}$</span></p><p>The SRK and PR equations of state are comparable in performance, although the latter generally provides liquid densities with a greater degree of accuracy, while the former usually provides better fugacities. However, when it comes to modelling complex species such as polymers (macromolecules), or associating species, both equations struggle to perform well. This is unsurprising, since the underlying molecular model remains, in essence, a &quot;van der Waalsian sphere&quot; – in other words,a hard spherical core surrounded by a region of attraction. A more sophisticated molecular model is required to account well for the increased molecular complexities of these species.</p><p>Before moving on from cubic equations of state we note that, within <code>Clapeyron</code>, the cubic plus association (<code>CPA</code>) equation of state is supported. A CPA equation is the amalgamation of a cubic equation (usually SRK, as in <code>Clapeyron</code>, or PR) with the association term from the SAFT equation, which we will meet later. Strictly speaking, it is neither a cubic nor a SAFT equation of state but, rather, occupies a middle ground between these two classes of equation.</p><p>Something that may be apparent in all these equations is the fact that these are all functions that return the pressure and, thus, must be integrated to obtain the Helmholtz energy. Like the ideal gas equation, there will be missing temperature and compositional dependencies which need to be included.</p><h4 id="Mixtures-with-cubic-equations-of-state"><a class="docs-heading-anchor" href="#Mixtures-with-cubic-equations-of-state">Mixtures with cubic equations of state</a><a id="Mixtures-with-cubic-equations-of-state-1"></a><a class="docs-heading-anchor-permalink" href="#Mixtures-with-cubic-equations-of-state" title="Permalink"></a></h4><p>One may wonder how to model mixtures using such equations. This can be achieved using <em>mixing rules</em>, in conjunction with <em>combining rules</em>. Although there are many variants, one of the more popular mixing rules is the Van der Waals one-fluid mixing rule: the mixture is treated as a hypothetical pure fluid, characterised by parameters <span>$\bar{a}$</span> and <span>$\bar{b}$</span> that are given by</p><p><span>$\bar{a}=\sum_i\sum_jx_ix_ja_{ij}$</span></p><p><span>$\bar{b}=\sum_i\sum_jx_ix_jb_{ij}$</span></p><p>When <span>$i=j$</span>, <span>$a$</span> and <span>$b$</span> are just the normal Van der Waals parameters for the pure. However, when <span>$i\neq j$</span>, these parameter characterise the unlike interactions between <span>$i$</span> and <span>$j$</span>. We typically need to use <em>combining rules</em> (not to be confused with <em>mixing rules</em>) to determine the unlike parameters. Examples of these include:</p><p><span>$b_{ij}=\frac{b_i+b_j}{2}$</span></p><p><span>$a_{ij} = (1-k_{ij})\sqrt{a_ia_j}$</span></p><p>where <span>$k_{ij}$</span> can be set to 0 but, using either more advanced combining rules or regression to experimental data, can be tuned to improve the effectiveness of the combining rule. Further details on this will be given for the SAFT models.</p><p>More complicated mixing rules (such as the Wong–Sandler mixing rule) are available and implemented in <code>Clapeyron</code>.</p><h3 id="SAFT-equations-of-state"><a class="docs-heading-anchor" href="#SAFT-equations-of-state">SAFT equations of state</a><a id="SAFT-equations-of-state-1"></a><a class="docs-heading-anchor-permalink" href="#SAFT-equations-of-state" title="Permalink"></a></h3><p>In comparison to the cubic equations of state, equations based on the Statistical Associating Fluid Theory (SAFT) are based on a more theoretical approach, although still can be considered as descendants of Van der Waals&#39; equation. As mentioned earlier, the Van der Waals equation can be derived from statistical mechanics, whereby the Helmholtz energy of the Van der Waals fluid is obtained as</p><p><span>$\frac{A}{Nk_\mathrm{B}T} = \frac{A_\mathrm{ideal}}{Nk_\mathrm{B}T}+\frac{A_\mathrm{HS}}{Nk_\mathrm{B}T}+\frac{A_\mathrm{1}}{(Nk_\mathrm{B}T)^2}$</span>;</p><p>here the ideal and hard-sphere (HS) terms combine to give the repulsive term (of the pressure form of the equation) whilst the <span>$A_1$</span> term results in the attractive term. We can see from this that, using the Van der Waals equation, species are effectively modelled as hard spheres with dispersive interactions (we sometimes call these London dispersion interactions). The latter two terms can be merged into what is referred to as the monomer or segment term.</p><p>Whilst, as already noted, this is clearly a step up from the ideal gas, most species can&#39;t be modelled effectively as single spheres; they may be highly non-spherical in shape (as is usually the case with large molecules), or they may experience interactions that are more complex than simple dispersion. A classic example of the latter is water; although the water molecule is small and (at first glance) may appear simple, the behaviour of water is very strongly influenced by hydrogen bonding interactions.</p><p>Using Wertheim&#39;s TPT1 theory of association, it is possible to model molecules as chains of spheres; the shape of the model molecule can thereby be tailored to represent that of the real molecule far better than a single sphere. Wertheim&#39;s TPT1 theory can also be used to account for intermolecular association interactions (such as dipole–dipole interactions, or hydrogen bonding), which are strongly directional. These are described using associations sites that are located on one or more of the spherical segments comprising the chain molecule. This results in the addition of two extra contributions to the Helmholtz energy (note that the HS and dispersive terms have been merged into a monomer term):</p><p><span>$\frac{A}{Nk_\mathrm{B}T} = \frac{A_\mathrm{ideal}}{Nk_\mathrm{B}T}+\frac{A_\mathrm{mono.}}{Nk_\mathrm{B}T}+\frac{A_\mathrm{chain}}{Nk_\mathrm{B}T}+\frac{A_\mathrm{assoc.}}{Nk_\mathrm{B}T}$</span></p><p>The chain term accounts for the formation of chains of spherical segments and is generally expressed as</p><p><span>$\frac{A_\mathrm{chain}}{Nk_\mathrm{B}T}=-\sum_ix_i(m_i-1)\ln{g_{ii}(d_{ii})}$</span>,</p><p>where <span>$g_{ii}(r_{ii})$</span> is the pair distribution function for species <span>$i$</span> (which carries information about the structure of the fluid; it expresses how likely it is that a segment of species <span>$i$</span> is present at a distance <span>$r_{ii}$</span> from another segment of species <span>$i$</span>). Many SAFT equations differ in how this pair distribution function is expressed. We note here the introduction of the Barker–Henderson hard-sphere diameter, <span>$d_{ii}$</span> which is given (dropping the subscripts for clarity) by</p><p><span>$d = \int_0^\sigma (1-\exp{-\beta\phi(r)})dr$</span>;</p><p>here <span>$\phi(r)$</span> is our <em>effective</em> pair potential and <span>$\beta=1/(k_\mathrm{B}T)$</span>. This effectively gives a temperature dependence to the size of our segment and accounts for our segment becoming <em>softer</em> as temperature rises.</p><p>The association term accounts for the highly directional associative interactions (for example, hydrogen bonding). For most SAFT equations of state, it is expressed as:</p><p><span>$\frac{A_\mathrm{assoc.}}{Nk_\mathrm{B}T}=\sum_ix_i\left(\sum_a\left(\ln{X_{i,a}}-\frac{X_{i,a}}{2}\right)+\frac{M_i}{2}\right)$</span></p><p>where <span>$X_{i,a}$</span> is the fraction of association sites <span>$a$</span> on species <span>$i$</span> <em>not</em> bonded to another and <span>$M_i$</span> is the number of association sites on species <span>$i$</span>. <span>$X_{i,a}$</span> can be obtained by solving the following system of equations:</p><p><span>$X_{i,a} = (1+\rho\sum_jx_j\sum_bX_{j,b}\Delta_{ij,ab})^{-1}$</span></p><p>An important aspect of the association term is that the above system of equations typically needs to be solved iteratively; this greatly increases the computational cost of the SAFT equations when modelling associating species (compared to modelling non-associating species, for example, or to using cubic equations of state). <span>$\Delta_{ij,ab}$</span> is the association strength between site <span>$a$</span> on species <span>$i$</span> with site <span>$b$</span> on species <span>$j$</span>; this is also an aspect where SAFT equations usually differ but can all be written generally as</p><p><span>$\Delta_{ij,ab} = F_{ij,ab}K_{ij,ab}I_{ij,ab}$</span></p><p>where <span>$F_{ij,ab}$</span> is Mayer&#39;s function, given by</p><p><span>$F = \exp{-\beta\epsilon^\mathrm{assoc.}}-1$</span>,</p><p>where <span>$\epsilon^\mathrm{assoc.}$</span> is the potential depth of the association interaction. <span>$K$</span> and <span>$I$</span> differ between equations but, generally, these represent the length scale of the interaction and the likelihood that the sites are correctly orientated such that they overlap, respectively.</p><p>Surprisingly, the monomer term is one of the aspects that most distinguishes the different SAFT equations; no two variants use the same equation. However, in general, the monomer term is composed of more than one term:</p><p><span>$\frac{A_\mathrm{mono.}}{Nk_\mathrm{B}T}=\frac{A_\mathrm{HS}}{Nk_\mathrm{B}T}+\frac{A_\mathrm{1}}{(Nk_\mathrm{B}T)^2}+\frac{A_\mathrm{2}}{(Nk_\mathrm{B}T)^3}+\frac{A_\mathrm{3}}{(Nk_\mathrm{B}T)^4}+...$</span></p><p>This expression is known as a Barker–Henderson perturbative expansion. These terms generally account for the dispersive interactions between segments; the <span>$n^\mathrm{th}$</span> order term account for interactions between <span>$n$</span> segments. In most SAFT equations, this expansion is truncated at just the second-order term.</p><h4 id="Parameters"><a class="docs-heading-anchor" href="#Parameters">Parameters</a><a id="Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Parameters" title="Permalink"></a></h4><p>Although different SAFT equations use different parameters, most share a common set. These include the parameters that characterise the dispersive interactions (which are usually modelled as pair potentials): the potential depth <span>$\epsilon$</span> (usually expressed as <span>$\epsilon / k_{\mathrm{B}}$</span>, in Kelvin) and the segment size <span>$\sigma$</span> (in Angstrom). We point out here that this potential (and its parameters) is not a <em>bare</em> pair potential, which accounts only for the interactions of two species (in vacuum); it is an <em>effective</em> pair potential, which accounts for the effects of other species being around the interacting pair, in some cases quantum effects and, if associative interactions are not modelled separately, account for non-dispersive interactions.</p><p>As species can now be modelled as chains of segments, the number of segments, <span>$m$</span>, also becomes a parameter. One thing to point out about this parameter is that it need not be an integer (despite what its name suggests); non-integer values of <span>$m$</span> can usually be interpreted as segments merging within the chain.</p><p>In the case of associating species, SAFT equations usually require a parameter for the potential well depth of the association, <span>$\epsilon^\mathrm{assoc.}$</span> (analogously to <span>$\epsilon$</span>, this is usually expressed as <span>$\epsilon^\mathrm{assoc.} / k_{\mathrm{B}}$</span>, in Kelvin) and a parameter characterising the length scale of the interaction (either a bonding volume, <span>$\kappa^\mathrm{assoc.}$</span>, usually expressed in Å<span>$^3$</span>, or a length, <span>$r_c^\mathrm{assoc.}$</span>, either in meters or dimensionless (reduced by the segment size)). In the case of the dispersive and associative interaction parameters, there will also be the equivalent parameters characterising unlike interactions between species in a mixture (which can also be obtained from combining rules).</p><p>Unfortunately, due to the complex function form of SAFT equations, it is impossible to directly relate these parameters to critical properties, as is done with the engineering cubics. Instead, these parameters are typically obtained by regression using experimental data (typically pure component saturation pressure and saturated liquid density data).</p><p>We will next go through each of the variants of the SAFT equation available in <code>Clapeyron</code> and what makes these unique.</p><h4 id="Original-SAFT"><a class="docs-heading-anchor" href="#Original-SAFT">Original SAFT</a><a id="Original-SAFT-1"></a><a class="docs-heading-anchor-permalink" href="#Original-SAFT" title="Permalink"></a></h4><p>Derived by Chapman et al. (1990), this is the first variant of the SAFT equation of state. This equation can be seen as a `proof of concept&#39; as not many parameters are available (none for mixtures). Nevertheless, a noteworthy feature of this equation is the use of a semi-empirical equation to obtain the hard-sphere diameter that depends on the number of segments of a species (in no other SAFT variant is this done). The hard-sphere pair distribution is used in the chain term; this has a much simpler analytical form than what is chosen for use in some other SAFT equations. The association strength, <span>$\Delta$</span> is evaluated in a unique way as well:</p><p><span>$\Delta_{ij,ab}=d_{ij}^3g_{ij}^\mathrm{HS}F_{ij,ab}\kappa_{ij,ab}$</span></p><p>where <span>$\kappa_{ij,ab}$</span> is dimensionless. Unfortunately, the implementation of <code>ogSAFT</code> in <code>Clapeyron</code> cannot yet replicate the figures from the original paper. The reason for this is that the monomer / segment term presented in the paper is not the one used to generate the results. The actual term used is developed by Twu et al. (1980) and we are currently attempting to implement this within <code>Clapeyron</code> but it is not clear, as of yet, how it was implemented within the original equation.</p><h4 id="CK‑SAFT"><a class="docs-heading-anchor" href="#CK‑SAFT">CK‑SAFT</a><a id="CK‑SAFT-1"></a><a class="docs-heading-anchor-permalink" href="#CK‑SAFT" title="Permalink"></a></h4><p>If the SAFT equation derived by Chapman et al. was the prototype, the variant developed by Huang and Radosz (1990) was the first usable SAFT equation, with over 100 pure component parameters and many unlike parameters available. Many of the computationally intensive parts of <code>ogSAFT</code> are simplified in <code>CKSAFT</code>; a simpler equation is used to obtain the hard-sphere diameter, and the monomer term provided within the paper is the correct one. The chain term is identical in the two equations. Similarly, the association strength only has a minor change:</p><p><span>$\Delta_{ij,ab}=\sigma_{ij}^3g_{ij}^\mathrm{HS}F_{ij,ab}\kappa_{ij,ab}$</span>;</p><p>this slightly reduces the computational cost. However, the most noteworthy simplification came with the association term. As mentioned earlier, the association fraction needs to be solved for iteratively. However, Huang and Radosz proposed approximations of the association fraction that could be used to solve for the association term explicitly, greatly reducing the computational intensity of these calculations. Our current association solver returns analytic solutions for some simple cases (two sites interacting with each other or one self-interacting site). We also point out that Huang and Radosz introduced the concept of association schemes, which helps classify species based on how they interaction through association.</p><h4 id="SAFT‑VR-SW"><a class="docs-heading-anchor" href="#SAFT‑VR-SW">SAFT‑VR SW</a><a id="SAFT‑VR-SW-1"></a><a class="docs-heading-anchor-permalink" href="#SAFT‑VR-SW" title="Permalink"></a></h4><p>Gil-Villegas et al. (1997) developed a new class of SAFT equations known as SAFT variable range. Here, more emphasis was placed on the potentials used to characterise dispersion interactions, and a new parameter was introduced through the potential shape. Whilst many versions of SAFT‑VR are proposed, each using different underlying potentials, the one that was chosen as the default was SAFT‑VR square-well (SW) with the additional &quot;potential shape parameter&quot; <span>$\lambda$</span> (characterising the width of the potential well). Within this framework, novel expressions for the monomer and chain terms were proposed, both being based on the SW potential. The association term remained largely unchanged, with the association strength having the most noteworthy modification:</p><p><span>$\Delta_{ij,ab}=g_{ij}^\mathrm{SW}F_{ij,ab}\kappa_{ij,ab}$</span>.</p><p>Here, <span>$\kappa_{ij,ab}$</span> now carries units of volume. Not many parameters are available for this equation of state, primarily being used to model alkanes and perfluoroalkanes. However, compared to most other SAFT variants, SAFT–VR SW has possibly seen the most extensions, having a group-contribution alternative (SAFT–<span>$\gamma$</span> SW), electrolyte (SAFT–VRE SW) and crossover theory (SAFT‑VRX SW).</p><h4 id="soft‑SAFT"><a class="docs-heading-anchor" href="#soft‑SAFT">soft‑SAFT</a><a id="soft‑SAFT-1"></a><a class="docs-heading-anchor-permalink" href="#soft‑SAFT" title="Permalink"></a></h4><p>Developed by Blas and Vega (2001), whereas the SAFT equations discussed up until now had been based on a hard-sphere reference from which to build the equation of state, in soft‑SAFT a Lennard-Jones reference is used instead. Because of this, compared to all other SAFT equations, soft‑SAFT relies heavily on correlations obtained from molecular dynamics simulations to obtain the monomer term, pair distribution function and association strength. Like SAFT‑VR SW, soft‑SAFT does not have an extensive database of parameters, but has been extended multiple times (crossover theory being the more noteworthy extension).</p><h4 id="PC‑SAFT"><a class="docs-heading-anchor" href="#PC‑SAFT">PC‑SAFT</a><a id="PC‑SAFT-1"></a><a class="docs-heading-anchor-permalink" href="#PC‑SAFT" title="Permalink"></a></h4><p>Possibly the most popular variant of the SAFT equation, Perturbed-Chain (not polymer-chain) SAFT was developed by Gross and Sadowski (2001) and, like soft‑SAFT, a different reference state is chosen, as compared with previous SAFT equations. This time, we start from the hard-chain (HC), not the hard-sphere, expressing the SAFT equation as:</p><p><span>$\frac{A}{Nk_\mathrm{B}T} = \frac{A_\mathrm{ideal}}{Nk_\mathrm{B}T}+\frac{A_\mathrm{HC}}{Nk_\mathrm{B}T}+\frac{A_\mathrm{disp.}}{Nk_\mathrm{B}T}+\frac{A_\mathrm{assoc.}}{Nk_\mathrm{B}T}$</span></p><p>This isn&#39;t as significant a change as one might initially think as, effectively, the hard-sphere and chain terms (which uses a hard-sphere pair distribution function like CK‑SAFT) are combined into the hard-chain term. The dispersion term is then simply another correlation, only this time depending on the number of segments as well. It carries many similarities with CK‑SAFT, using the same expression for the hard-sphere diameter, pair distribution function and association term.</p><p>The primary reasons behind PC‑SAFT&#39;s popularity are threefold. For one, the code for PC‑SAFT is available open-source. Secondly, there is an abundance of parameters available (over 250), including unlike parameters. Finally, many variants of the PC‑SAFT equation have been developed. These include:</p><ul><li>Polar PC‑SAFT (PPC‑SAFT)</li><li>PC‑Polar SAFT (PCP‑SAFT); yes, these are distinct equations</li><li>Electrolyte PC‑SAFT (ePC‑SAFT)</li><li>Electrolyte PPC‑SAFT (ePPC‑SAFT)</li><li>Polyelectrolyte ePC‑SAFT (epPC‑SAFT)</li><li>Critical-point based PC‑SAFT (CP‑PC‑SAFT)</li><li>Critical-point based PPC‑SAFT (CP‑PPC‑SAFT)</li><li>Group-contribution PC‑SAFT (GC‑PC‑SAFT)</li><li>Group-contribution PPC‑SAFT (GC‑PPC‑SAFT)</li></ul><p>We will aim to provide some of these variants at a later date.</p><h4 id="sPC‑SAFT"><a class="docs-heading-anchor" href="#sPC‑SAFT">sPC‑SAFT</a><a id="sPC‑SAFT-1"></a><a class="docs-heading-anchor-permalink" href="#sPC‑SAFT" title="Permalink"></a></h4><p>Known as the simplified PC‑SAFT equation (developed by Von Solms et al. (2003)). Here, the only modifications are to the hard-chain and association terms where, instead of using the generalised expressions for the hard-sphere term and hard-sphere pair distribution function, by averaging the hard-sphere diameter (effectively treating mixtures as being made up of identically sized segments), the pure component versions of these properties are used instead. The benefit of this is that pure component parameters determined for PC‑SAFT can still be used here, and only the unlike parameters need to be modified.</p><p>Similar to PC‑SAFT, variants of the sPC‑SAFT equation also exist, although nowhere near as extensive. Most notably, a significant group-contribution method is available.</p><h4 id="SAFT‑VR-Mie"><a class="docs-heading-anchor" href="#SAFT‑VR-Mie">SAFT‑VR Mie</a><a id="SAFT‑VR-Mie-1"></a><a class="docs-heading-anchor-permalink" href="#SAFT‑VR-Mie" title="Permalink"></a></h4><p>One of the most novel SAFT equations of state, derived by Lafitte et al. (2013), this equation is effectively an extension of the SAFT‑VR framework developed by Gil-Villegas et al. (1997), with further improvements. First of these is extending the Barker–Henderson perturbative expansion to third order instead of second order:</p><p><span>$\frac{A_\mathrm{mono.}}{Nk_\mathrm{B}T}=\frac{A_\mathrm{HS}}{Nk_\mathrm{B}T}+\frac{A_\mathrm{1}}{(Nk_\mathrm{B}T)^2}+\frac{A_\mathrm{2}}{(Nk_\mathrm{B}T)^3}+\frac{A_\mathrm{3}}{(Nk_\mathrm{B}T)^4}$</span></p><p>We do point out that, whilst the first two terms are developed following the SAFT‑VR framework, the third-order term is more akin to a correlation regressed using molecular dynamics simulation data for Mie fluids. This third-order term resulted in significant improvements in the modelling of properties near the critical point (without using cross-over theory). The chain term also received further improvements as a result. This is also the only SAFT equation in which the hard-sphere diameter is evaluated analytically, although numerical approximations are needed (we note that the original SAFT‑VR Mie equation used 10-point Gauss–Legendre quadrature, whilst the newer version uses 5-point Gauss–Laguerre quadrature). The <code>Clapeyron.jl</code> implementation of the hard-sphere diameter uses a mixed approach, using 10-point Gauss–Laguerre quadrature for low reduced temperatures (<code>T/ε</code>) and a 10-point Gauss–Legendre integration with a cutoff radius for high temperatures.</p><p>However, three different versions of the association strength have been developed:</p><ul><li><p>Hard-sphere kernel:</p><p><span>$\Delta_{ij,ab}=\sigma_{ij}^3g_{ij}^\mathrm{HS}F_{ij,ab}K_{ij,ab}$</span></p></li><li><p>Lennard-Jones kernel:</p><p><span>$\Delta_{ij,ab}=F_{ij,ab}K_{ij,ab}I_{ij,ab}(\epsilon_{ij},\sigma_{ij})$</span></p></li><li><p>Mie kernel:</p><p><span>$\Delta_{ij,ab}=F_{ij,ab}K_{ij,ab}I_{ij,ab}(\epsilon_{ij},\sigma_{ij},\lambda_{ij})$</span></p></li></ul><p>Unfortunately, it seems that there have been inconsistencies between which of these kernels is used in different publications. In the current &#39;default&#39; SAFT‑VR Mie equation the Lennard-Jones kernel is used; as such, this is the one used in <code>Clapeyron</code>. The Mie kernel is available with the <a href="../../eos/saft/#Clapeyron.SAFTVRMie15"><code>SAFTVRMie15</code></a> equation of state.</p><p>As a Mie potential is characterised by two shape parameters, <span>$\lambda_\mathrm{a}$</span> (characterising the attractive part) and <span>$\lambda_\mathrm{r}$</span> (characterising the repulsive part), both of these have become parameters for each species (although <span>$\lambda_\mathrm{a}$</span> is usually set to 6). As we have different association terms, we also have different sets of parameters where the only difference is the length scale. In the Lennard-Jones and Mie kernels, <span>$K_{ij,ab}$</span> is the &#39;bonding volume&#39;, whereas, in the hard-sphere kernel, it is a &#39;bonding length&#39;, <span>$r_{ij,ab}^c$</span>.</p><p>The SAFT‑VR Mie does not have a significantly large repository of parameters (compensated by its group-contribution variant) and has only been extended to electrolytes (SAFT‑VRE Mie and eSAFT‑VR Mie).</p><h4 id="SAFT‑VRQ-Mie"><a class="docs-heading-anchor" href="#SAFT‑VRQ-Mie">SAFT‑VRQ Mie</a><a id="SAFT‑VRQ-Mie-1"></a><a class="docs-heading-anchor-permalink" href="#SAFT‑VRQ-Mie" title="Permalink"></a></h4><p>A very recent extension of the SAFT‑VR Mie equation is the SAFT‑VRQ Mie equation developed by Aasen et al. (2019) in which the underlying Mie potential is modified using a Feynman–Hibbs potential, which means that a single species is represented by a sum of three Mie potentials. This method attempts to classically account for quantum effects present in small species such as helium, hydrogen and neon. Unfortunately, this equation is limited to just the monomer term and, even then, it is very computationally intensive.</p><h4 id="SAFT‑\\gamma-Mie"><a class="docs-heading-anchor" href="#SAFT‑\\gamma-Mie">SAFT‑<span>$\gamma$</span> Mie</a><a id="SAFT‑\\gamma-Mie-1"></a><a class="docs-heading-anchor-permalink" href="#SAFT‑\\gamma-Mie" title="Permalink"></a></h4><p>The group-contribution version of SAFT‑VR Mie, developed by Papaioannou et al. (2014), the SAFT‑<span>$\gamma$</span> Mie equation rests on the same general framework as SAFT‑VR Mie, although, as it is a group-contribution method, we are able to model heterogeneous chains (in SAFT equations discussed previously, all segments in a chain were the same size). The group‑contribution methodology is based on that developed by Lymperiadis et al. (2008). An interesting aesthetic change is with the number of segments where this is now separated into the shape factor, <span>$S$</span>, and the number of segments <span>$v^*$</span>. The latter must now be an integer and the former is a direct measure of how &#39;fused&#39; the segments are. Approximately 60 groups are currently available for this equation. A noteworthy advantage of using groups is that unlike parameters between groups can be estimated from pure component data; these can then be readily extended to mixtures without further regression.</p><p>This equation has also been extended to electrolytes through SAFT‑<span>$\gamma$</span>E Mie.</p><h2 id="Methods"><a class="docs-heading-anchor" href="#Methods">Methods</a><a id="Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Methods" title="Permalink"></a></h2><h3 id="The-problem"><a class="docs-heading-anchor" href="#The-problem">The problem</a><a id="The-problem-1"></a><a class="docs-heading-anchor-permalink" href="#The-problem" title="Permalink"></a></h3><p>The aim of this document is to outline all of the various tools used to obtain the relevant properties from a SAFT-type equation of state. In short, SAFT equations of state provide the Helmholtz energy of a system at a given composition <span>$\mathbf{z}$</span>, volume <span>$V$</span> and temperature <span>$T$</span>:</p><p><span>$A=A(\mathbf{z},V,T)$</span></p><p>Taking derivatives of this function (within the <code>Clapeyron</code> module, this is done using automatic differentiation) can give us a wide range of properties which are given in the appendix. However, it is more common that we are interested in the state of a system at certain conditions (<span>$\mathbf{z}_0$</span>, <span>$p_0$</span> , <span>$T_0$</span>). The answer to this can be determined from the following, deceptively simple, minimisation of the Gibbs energy:</p><p><span>$\min G(\mathbf{z}_0,p_0,T_0)$</span></p><p>In the case of SAFT-type equations of state, this can be expressed as:</p><p><span>$\min A(\mathbf{z}_0,V,T_0)+p_0V$</span></p><p>What isn&#39;t obvious in this formulation of the problem is how to identify the variables that are to be optimised. Re-expressing this problem in greater detail:</p><p><span>$\min \sum_{i=1}^{n_\mathrm{phase}}\phi_i(A(\mathbf{z}_i,V_i,T_0)+p_0V_i)$</span></p><p><span>$\mathrm{s.t.} \left(\sum_{i=1}^{n_\mathrm{phases}}\phi_iz_{j,i}\right)-z_{j,0}=0\quad\forall j \in [1,n_\mathrm{species}]$</span></p><p>where the subscript <span>$i$</span> denotes properties related to a phase <span>$i$</span>, and <span>$\phi_i$</span> is the molar fraction of phase <span>$i$</span>. One can already see the difficulties behind solving such a problem as we do not often know beforehand how many phases there may be at the conditions (<span>$\mathbf{z}_0$</span>, <span>$p_0$</span> , <span>$T_0$</span>) and thus, we won&#39;t know which variables to optimise. In addition, we will want the global minimum and, particularly in systems with many components, there may be many local minima that we will need to eliminate.</p><p>Nevertheless, if we know certain things about the system beforehand, we can reduce the problem to one that is easier to solve.</p><h3 id="Volume-solvers"><a class="docs-heading-anchor" href="#Volume-solvers">Volume solvers</a><a id="Volume-solvers-1"></a><a class="docs-heading-anchor-permalink" href="#Volume-solvers" title="Permalink"></a></h3><p>Let us make one simplifying assumption: we know that the system exists in a single phase. This greatly simplifies the problem to:</p><p><span>$\min_V A(\mathbf{z}_0,V,T_0)+p_0V$</span></p><p>where, as there is no phase split, the only variable we need to optimise is the volume. We can see that this is equivalent to solving for the volume at which the pressure predicted by the equation of state equals <span>$p_0$</span>:</p><p><span>$\min_V A(\mathbf{z}_0,V,T_0)+p_0V\rightarrow\frac{\partial }{\partial V}(A(\mathbf{z}_0,V,T_0)+p_0V)=\frac{\partial A}{\partial V}(\mathbf{z}_0,V,T_0)+p_0=-p(\mathbf{z}_0,V,T_0)+p_0=0$</span></p><p>Effectively, we can reword this as a root-finding problem. One slight issue with this is that there is often more than one root (there can actually be up to five, even in SAFT-type equations). The true root will be the one that minimises the Gibbs energy; thus we must first find the candidate phases and determine their Gibbs energy before reporting the volume.</p><p>For the cubics, this problem is quite straightforward given that (as the name suggests) all these equations can be rearranged as a cubic equation in <span>$V$</span>:</p><p><span>$p_0=\frac{RT_0}{V-b}-\frac{a}{(V-c_1)(V-c_2)}\rightarrow a_0+a_1V+a_2V^2+a_3V^3=0$</span>.</p><p>Thus, it is very easy to solve for all the roots in a cubic using analytical expressions. However, for other equations of state, we must use non-linear root-finding algorithms. In order to avoid the unstable phases, we try to use initial guesses close to what will be the &#39;true&#39; phases:</p><ol><li><p>Vapour: Since we can use automatic differentiation to obtain the virial coefficient for any model, we can actually obtain an initial guess extremely close to the final solution using</p><p><span>$\frac{p_0}{RT_0} = \frac{n_0}{V}+\frac{n_0}{V^2}B(T)\rightarrow V_0=\frac{RT_0}{p_0}\frac{-1+\sqrt{1+4p_0B(T_0)/(RT_0)}}{2}$</span>.</p></li><li><p>Liquid: The best we can do here is to obtain the volume corresponding to a large packing fraction (we typically pick 0.6 to 0.8):</p><p><span>$V_0 = \frac{N_\mathrm{A}\pi}{6\times 0.8}m\sigma^3$</span>.</p><p>We are still looking for ways to improve this but the volume function is quite reliable as of now.</p></li></ol><p>One other issue to consider when solving this problem is that, within the liquid phase, the gradients are very large; this can be difficult for algorithms to handle (even when providing the exact derivatives through automatic differentiation). We try to reduce magnitude of these derivatives by solving for the logarithm of the volume instead.</p></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.0 on <span class="colophon-date" title="Monday 17 November 2025 20:30">Monday 17 November 2025</span>. Using Julia version 1.12.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
